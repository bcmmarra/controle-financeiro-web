{% extends 'base.html' %}

{% block conteudo %}
<h2 style="color: #2c3e50;">Resumo Financeiro</h2>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
    <div style="background: white; padding: 25px; border-radius: 8px; border-left: 5px solid #2ecc71; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
        <small style="color: #888;">GASTO TOTAL ({{ datetime_now.strftime('%B') }})</small>
        <h2 style="margin: 10px 0; color: #2ecc71;">R$ {{ "%.2f"|format(gasto_mes) }}</h2>
    </div>

    <div style="background: white; padding: 25px; border-radius: 8px; border-left: 5px solid #e74c3c; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
        <small style="color: #888;">PRÓXIMO VENCIMENTO</small>
        {% if proxima_conta %}
            <h2 style="margin: 10px 0; color: #e74c3c;">R$ {{ "%.2f"|format(proxima_conta.valor_total) }}</h2>
            <p style="margin: 0; font-size: 0.8em; color: #555;">{{ proxima_conta.descricao }}</p>
        {% else %}
            <h2 style="margin: 10px 0; color: #bdc3c7;">---</h2>
        {% endif %}
    </div>
</div>

<div style="text-align: center;">
    <a href="/novo_lancamento" style="background: #3498db; color: white; padding: 12px 30px; border-radius: 25px; text-decoration: none; font-weight: bold;">+ Nova Transação</a>
</div>

<div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 30px;">
    <h3 style="text-align: center; color: #555;">Distribuição por Categoria</h3>
    <div style="max-width: 400px; margin: 0 auto;">
        <canvas id="meuGrafico"></canvas>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const ctx = document.getElementById('meuGrafico').getContext('2d');
    const meuGrafico = new Chart(ctx, {
        type: 'doughnut', // Gráfico estilo Rosca (pode ser 'pie' também)
        data: {
            labels: {{ labels|tojson }}, // Recebe os nomes das categorias do Python
            datasets: [{
                data: {{ valores|tojson }}, // Recebe os valores do Python
                backgroundColor: [
                    '#3498db', '#2ecc71', '#f1c40f', '#e74c3c', '#9b59b6', '#1abc9c', '#e67e22'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
</script>
{% endblock %}